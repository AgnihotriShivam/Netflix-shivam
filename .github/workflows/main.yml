name: Deploy to AWS ECR
 
on:

  push:

    branches:

      - main
 
jobs:

  build-and-push:

    runs-on: ubuntu-latest

    steps:

      - name: Checkout Repository

        uses: actions/checkout@v3
 
      - name: Login to AWS ECR

        uses: aws-actions/amazon-ecr-login@v1
 
      - name: Build Docker Image

        run: |

          docker build -t netflix .

      - name: Tag Docker Image

        run: |

          docker tag netflix:latest 476768693646.dkr.ecr.eu-north-1.amazonaws.com/devops_sec:latest
 
      - name: Push Docker Image to AWS ECR

        run: |

          docker push 476768693646.dkr.ecr.eu-north-1.amazonaws.com/devops_sec:latest

 
